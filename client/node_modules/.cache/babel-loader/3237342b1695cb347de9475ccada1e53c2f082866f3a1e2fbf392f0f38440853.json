{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport \"./States.css\";\nfunction States() {\n  _s();\n  const [states, setStates] = useState([]);\n  const [devices, setDevices] = useState([]);\n  const [sensors, setSensors] = useState([]);\n  const [selectedDevice, setSelectedDevice] = useState(\"\");\n  const [newState, setNewState] = useState({\n    name: \"\",\n    device_name: \"\",\n    condition: \"\",\n    sensor_name: \"\",\n    parameter: \"\"\n  });\n  useEffect(() => {\n    fetch(\"/states\").then(res => {\n      if (!res.ok) {\n        throw new Error(`HTTP error ${res.status}`);\n      }\n      return res.json();\n    }).then(data => setStates(data)).catch(err => console.error(\"Error fetching states:\", err));\n    fetch(\"/devices\").then(res => {\n      if (!res.ok) {\n        throw new Error(`HTTP error ${res.status}`);\n      }\n      return res.json();\n    }).then(data => setDevices(data)).catch(err => console.error(\"Error fetching devices:\", err));\n  }, []);\n  const handleInputChange = e => {\n    setNewState({\n      ...newState,\n      [e.target.name]: e.target.value\n    });\n    if (e.target.name === \"device_name\") {\n      setSelectedDevice(e.target.value);\n      fetch(`/boards/${e.target.value}`).then(res => {\n        if (!res.ok) {\n          throw new Error(`HTTP error ${res.status}`);\n        }\n        return res.json();\n      }).then(data => {\n        var _latestData$;\n        const latestData = data.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));\n        setSensors(((_latestData$ = latestData[0]) === null || _latestData$ === void 0 ? void 0 : _latestData$.sensors.map(sensor => sensor.name)) || []);\n      }).catch(err => console.error(\"Error fetching boards:\", err));\n    }\n  };\n  const handleSubmit = e => {\n    e.preventDefault();\n    fetch(\"/states\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(newState)\n    }).then(res => {\n      if (!res.ok) {\n        throw new Error(`HTTP error ${res.status}`);\n      }\n      return res.json();\n    }).then(data => {\n      setStates([...states, data]);\n      setNewState({\n        name: \"\",\n        device_name: \"\",\n        condition: \"\",\n        sensor_name: \"\",\n        parameter: \"\"\n      });\n    }).catch(err => console.error(\"Error submitting new state:\", err));\n  };\n}\n_s(States, \"uVSVbLZxS7K+XJLmNOTfI32Wtx8=\");\n_c = States;\nexport { States };\nvar _c;\n$RefreshReg$(_c, \"States\");","map":{"version":3,"names":["React","useState","useEffect","States","_s","states","setStates","devices","setDevices","sensors","setSensors","selectedDevice","setSelectedDevice","newState","setNewState","name","device_name","condition","sensor_name","parameter","fetch","then","res","ok","Error","status","json","data","catch","err","console","error","handleInputChange","e","target","value","_latestData$","latestData","sort","a","b","Date","timestamp","map","sensor","handleSubmit","preventDefault","method","headers","body","JSON","stringify","_c","$RefreshReg$"],"sources":["D:/COS40004/COS40004_Project/client/src/States.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"./States.css\";\r\n\r\nfunction States() {\r\n  const [states, setStates] = useState([]);\r\n  const [devices, setDevices] = useState([]);\r\n  const [sensors, setSensors] = useState([]);\r\n  const [selectedDevice, setSelectedDevice] = useState(\"\");\r\n  const [newState, setNewState] = useState({\r\n    name: \"\",\r\n    device_name: \"\",\r\n    condition: \"\",\r\n    sensor_name: \"\",\r\n    parameter: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetch(\"/states\")\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(`HTTP error ${res.status}`);\r\n        }\r\n        return res.json();\r\n      })\r\n      .then((data) => setStates(data))\r\n      .catch((err) => console.error(\"Error fetching states:\", err));\r\n\r\n    fetch(\"/devices\")\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(`HTTP error ${res.status}`);\r\n        }\r\n        return res.json();\r\n      })\r\n      .then((data) => setDevices(data))\r\n      .catch((err) => console.error(\"Error fetching devices:\", err));\r\n  }, []);\r\n\r\n  const handleInputChange = (e) => {\r\n    setNewState({ ...newState, [e.target.name]: e.target.value });\r\n\r\n    if (e.target.name === \"device_name\") {\r\n      setSelectedDevice(e.target.value);\r\n      fetch(`/boards/${e.target.value}`)\r\n        .then((res) => {\r\n          if (!res.ok) {\r\n            throw new Error(`HTTP error ${res.status}`);\r\n          }\r\n          return res.json();\r\n        })\r\n        .then((data) => {\r\n          const latestData = data.sort(\r\n            (a, b) => new Date(b.timestamp) - new Date(a.timestamp)\r\n          );\r\n          setSensors(latestData[0]?.sensors.map((sensor) => sensor.name) || []);\r\n        })\r\n        .catch((err) => console.error(\"Error fetching boards:\", err));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    fetch(\"/states\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify(newState),\r\n    })\r\n      .then((res) => {\r\n        if (!res.ok) {\r\n          throw new Error(`HTTP error ${res.status}`);\r\n        }\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n        setStates([...states, data]);\r\n        setNewState({\r\n          name: \"\",\r\n          device_name: \"\",\r\n          condition: \"\",\r\n          sensor_name: \"\",\r\n          parameter: \"\",\r\n        });\r\n      })\r\n      .catch((err) => console.error(\"Error submitting new state:\", err));\r\n  };\r\n\r\n  \r\n}\r\n\r\nexport { States };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}